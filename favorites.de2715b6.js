let e="https://tasty-treats-backend.p.goit.global/api",t=document.querySelector(".js-recipes-grid"),a=document.querySelector(".js-favorites-grid"),i=document.getElementById("pagination"),n=document.querySelector(".js-categories-list"),r=document.querySelector(".js-popular-list"),o=document.querySelector(".all-categories-btn"),s=document.getElementById("recipe-modal"),c=document.getElementById("order-modal"),d=document.getElementById("rating-modal"),l=document.getElementById("modal-content"),m=document.getElementById("order-form");document.getElementById("rating-form");let u=document.getElementById("search-input"),g=document.getElementById("time-select"),p=document.getElementById("area-select"),y=document.getElementById("ingredient-select"),v=document.getElementById("reset-filters"),f={category:"",title:"",area:"",ingredient:"",time:"",limit:window.innerWidth<768?6:window.innerWidth<1280?8:9,page:1};async function h(t,i){let n=JSON.parse(localStorage.getItem("favorites"))||[],r=n.findIndex(e=>e._id===t);if(-1===r)try{i.classList.add("active"),i.innerHTML="‚ù§Ô∏è";let a=await fetch(`${e}/recipes/${t}`);if(!a.ok)throw Error("Veri alƒ±namadƒ±");let n=await a.json(),r=JSON.parse(localStorage.getItem("favorites"))||[];r.some(e=>e._id===t)||(r.push(n),localStorage.setItem("favorites",JSON.stringify(r)))}catch(e){console.error(e),i.classList.remove("active"),i.innerHTML="ü§ç"}else n.splice(r,1),localStorage.setItem("favorites",JSON.stringify(n)),i.classList.remove("active"),i.innerHTML="ü§ç",a&&L()}function L(){let e=JSON.parse(localStorage.getItem("favorites"))||[];0===e.length?a.innerHTML='<p style="text-align:center; width:100%; margin-top:20px;">Hen√ºz favori tarifiniz yok. ü§∑‚Äç‚ôÇÔ∏è</p>':E(e,a)}async function b(){if(n)try{let t=await fetch(`${e}/categories`);n.innerHTML=(await t.json()).map(e=>`
            <li><button class="category-btn" data-category="${e.name}">${e.name}</button></li>
        `).join(""),n.addEventListener("click",e=>{e.target.classList.contains("category-btn")&&(document.querySelectorAll(".category-btn").forEach(e=>e.classList.remove("active")),o&&o.classList.remove("active"),e.target.classList.add("active"),f.category=e.target.dataset.category,f.page=1,w())}),o&&o.addEventListener("click",()=>{document.querySelectorAll(".category-btn").forEach(e=>e.classList.remove("active")),o.classList.add("active"),f.category="",f.page=1,w()})}catch(e){console.error(e)}}async function w(){try{let a=new URLSearchParams(f);for(let[e,t]of[...a.entries()])t||a.delete(e);let n=await fetch(`${e}/recipes?${a}`),r=await n.json();if(0===r.results.length){t.innerHTML='<p style="grid-column:1/-1; text-align:center;">Tarif bulunamadƒ±.</p>',i.innerHTML="";return}E(r.results,t),function(e,t){if(!i||(i.innerHTML="",e<=1))return;let a="";for(let i=1;i<=e;i++)(1===i||i===e||i>=t-1&&i<=t+1)&&(a+=`<button class="pagination-btn ${i===t?"active":""}" data-page="${i}">${i}</button>`);i.innerHTML=a,i.querySelectorAll("button").forEach(e=>e.addEventListener("click",()=>{f.page=Number(e.dataset.page),w(),window.scrollTo(0,0)}))}(r.totalPages,f.page)}catch(e){console.error(e)}}function E(e,t){let a=JSON.parse(localStorage.getItem("favorites"))||[];t.innerHTML=e.map(e=>{let t=a.some(t=>t._id===e._id);return`
        <div class="recipe-card" style="background-image: url('${e.preview}');">
            <div class="card-icons">
                 <button class="heart-btn js-add-fav ${t?"active":""}" data-id="${e._id}">
                    ${t?"‚ù§Ô∏è":"ü§ç"}
                 </button>
            </div>
            <div class="card-info">
                <h3 class="card-title">${e.title}</h3>
                <p class="card-desc">${e.description||""}</p>
                <div class="card-bottom">
                    <span class="rating">\u{2B50} ${Math.round(10*e.rating)/10}</span>
                    <button class="see-recipe-btn" data-id="${e._id}">See recipe</button>
                </div>
            </div>
        </div>`}).join("")}function $(e){e.addEventListener("click",e=>{let t=e.target.closest(".js-add-fav");if(t)return void h(t.dataset.id,t);let a=e.target.closest(".see-recipe-btn");a&&k(a.dataset.id)})}function S(e){e&&(e.classList.toggle("is-hidden"),document.body.style.overflow=e.classList.contains("is-hidden")?"auto":"hidden")}async function k(t){try{S(s),l.innerHTML='<div style="padding:20px; text-align:center;">Y√ºkleniyor...</div>';let a=await fetch(`${e}/recipes/${t}`),i=await a.json(),n=`<img src="${i.preview}" style="width:100%; border-radius:10px;">`;if(i.youtube){let e=i.youtube.split("v=")[1];e&&(n=`<iframe width="100%" height="315" src="https://www.youtube.com/embed/${e}" frameborder="0" allowfullscreen style="border-radius:10px;"></iframe>`)}let r=(JSON.parse(localStorage.getItem("favorites"))||[]).some(e=>e._id===i._id);l.innerHTML=`
            ${n}
            <h2 class="modal-title" style="margin-top:15px;">${i.title}</h2>
            <div style="margin:10px 0;"><span style="background:#9BB537; color:#fff; padding:4px 10px; border-radius:15px; font-size:12px;">${i.time} min</span></div>
            <p class="modal-instructions" style="font-size:14px; opacity:0.8;">${i.instructions}</p>
            <div style="margin-bottom:20px;">
                <h4>Ingredients:</h4>
                <ul style="display:grid; grid-template-columns:1fr 1fr; gap:5px; font-size:13px;">
                    ${i.ingredients.map(e=>`<li>\u{2022} ${e.name} <span style="opacity:0.6">(${e.measure})</span></li>`).join("")}
                </ul>
            </div>
            <div style="display:flex; gap:10px; justify-content:center;">
                <button id="modal-fav-btn" style="background:${r?"#ccc":"#9BB537"}; color:white; border:none; padding:10px 20px; border-radius:8px;">${r?"Remove Favorite":"Add to Favorite"}</button>
                <button id="modal-rate-btn" style="background:orange; color:white; border:none; padding:10px 20px; border-radius:8px;">Give Rating</button>
            </div>
        `,document.getElementById("modal-fav-btn").addEventListener("click",e=>{h(i._id,{classList:{add:()=>{},remove:()=>{}},innerHTML:""}),e.target.innerText=e.target.innerText.includes("Add")?"Remove Favorite":"Add to Favorite",e.target.style.background=e.target.innerText.includes("Add")?"#9BB537":"#ccc";let t=document.querySelector(`.js-add-fav[data-id="${i._id}"]`);t&&(t.classList.toggle("active"),t.innerHTML=t.classList.contains("active")?"‚ù§Ô∏è":"ü§ç")}),document.getElementById("modal-rate-btn").addEventListener("click",()=>S(d))}catch(e){console.error(e)}}async function j(){if(r)try{let t=await fetch(`${e}/recipes/popular`);r.innerHTML=(await t.json()).map(e=>`
            <li data-id="${e._id}">
                <img src="${e.preview}">
                <div class="popular-info"><h4>${e.title}</h4><p>${e.description.substring(0,40)}...</p></div>
            </li>`).join(""),r.addEventListener("click",e=>{let t=e.target.closest("li");t&&k(t.dataset.id)})}catch(e){}}async function x(){try{let t=await fetch(`${e}/areas`),a=await t.json();a.sort((e,t)=>e.name.localeCompare(t.name)),p.innerHTML+=a.map(e=>`<option value="${e.name}">${e.name}</option>`).join("")}catch(e){}}async function T(){try{let t=await fetch(`${e}/ingredients`),a=await t.json();a.sort((e,t)=>e.name.localeCompare(t.name)),y.innerHTML+=a.map(e=>`<option value="${e._id}">${e.name}</option>`).join("")}catch(e){}}(async function i(){let i,n,r,l,h;(i=document.querySelector(".theme-switch"))&&("dark"===localStorage.getItem("theme")&&document.body.classList.add("dark-theme"),i.addEventListener("click",()=>{document.body.classList.toggle("dark-theme"),localStorage.setItem("theme",document.body.classList.contains("dark-theme")?"dark":"light")})),function(){let e=document.querySelector(".js-open-menu"),t=document.querySelector(".js-close-menu"),a=document.querySelector(".js-menu-container");if(e&&t&&a){let i=()=>a.classList.toggle("is-hidden");e.addEventListener("click",i),t.addEventListener("click",i)}}(),[s,c,d].forEach(e=>{e&&e.addEventListener("click",t=>{t.target===e&&S(e)})}),document.addEventListener("keydown",e=>{"Escape"===e.key&&[s,c,d].forEach(e=>{e&&!e.classList.contains("is-hidden")&&S(e)})}),(n=document.getElementById("close-modal"))&&n.addEventListener("click",()=>S(s)),(r=document.querySelector(".js-close-rating"))&&r.addEventListener("click",()=>S(d)),document.body.addEventListener("click",e=>{e.target.closest(".js-open-order")&&(e.preventDefault(),S(c))}),m&&m.addEventListener("submit",async t=>{t.preventDefault();let a=Object.fromEntries(new FormData(m).entries());try{if(!(await fetch(`${e}/orders/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw Error("Sipari≈ü hatasƒ±");alert("Sipari≈üiniz alƒ±ndƒ±! üõí Afiyet olsun."),S(c),m.reset()}catch(e){alert("Bir hata olu≈ütu. L√ºtfen tekrar deneyin."),console.error(e)}}),(l=document.querySelector(".js-close-order"))&&l.addEventListener("click",()=>S(c)),t?("u">typeof Swiper?new Swiper(".hero-swiper",{loop:!0,autoplay:{delay:5e3,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},allowTouchMove:!0}):console.warn("Swiper not loaded yet."),await b(),await j(),await x(),await T(),function(){let e="";for(let t=5;t<=120;t+=5)e+=`<option value="${t}">${t} min</option>`;g.innerHTML+=e}(),w(),u&&u.addEventListener("input",e=>{clearTimeout(h),h=setTimeout(()=>{f.title=e.target.value.trim(),f.page=1,w()},500)}),p&&p.addEventListener("change",e=>{f.area=e.target.value,f.page=1,w()}),y&&y.addEventListener("change",e=>{f.ingredient=e.target.value,f.page=1,w()}),g&&g.addEventListener("change",e=>{f.time=e.target.value,f.page=1,w()}),v&&v.addEventListener("click",()=>{u.value="",p.value="",y.value="",g.value="",f={category:"",title:"",area:"",ingredient:"",time:"",limit:f.limit,page:1},document.querySelectorAll(".category-btn").forEach(e=>e.classList.remove("active")),o&&o.classList.add("active"),w()}),$(t),window.addEventListener("resize",()=>{let e=window.innerWidth<768?6:window.innerWidth<1280?8:9;f.limit!==e&&(f.limit=e,w())})):a&&(L(),$(a))})();
//# sourceMappingURL=favorites.de2715b6.js.map
